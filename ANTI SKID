local ToolName = "1 Hand Jerk"
local KeepOnDeath = getgenv().KEEP_ON_DEATH

local Player = game.Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid", 1)
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart", 1) or Character.PrimaryPart

if not Character:FindFirstChild("Torso") then
    warn("Must be R6")
    return
end

if getgenv().ToolExecuted then
    warn("Already executed")
    return
end

getgenv().ToolExecuted = true

local MAIN_ANIMATIONS = {
    MAIN = "rbxassetid://99198989",
}

local UsingTool = false

local TestTool = Instance.new("Tool")
TestTool.Name = ToolName
TestTool.RequiresHandle = false
TestTool.Parent = game:GetService("ReplicatedStorage")

Player.CharacterAdded:Connect(function()
    Character = Player.Character
    Humanoid = Character:WaitForChild("Humanoid", 1)
    HumanoidRootPart = Character:WaitForChild("HumanoidRootPart", 1) or Character.PrimaryPart

    if KeepOnDeath then
        local new_tool = TestTool:Clone()
        new_tool.Parent = Player.Backpack
        
        new_tool.Equipped:Connect(function()
            UsingTool = true
        end)

        new_tool.Unequipped:Connect(function()
            UsingTool = false
        end)
    end

    Humanoid.Died:Connect(function()
        UsingTool = false
        if not KeepOnDeath then
            getgenv().ToolExecuted = false
        end
    end)
end)

local new_tool = TestTool:Clone()
new_tool.Parent = Player.Backpack

new_tool.Equipped:Connect(function()
    UsingTool = true
end)

new_tool.Unequipped:Connect(function()
    UsingTool = false
end)

Humanoid.Died:Connect(function()
    UsingTool = false
    if not KeepOnDeath then
        getgenv().ToolExecuted = false
    end
end)

local mainTrack
local setToOriginalValues = true

game:GetService("RunService").RenderStepped:Connect(function()
    if not Humanoid then
        return
    end
    if UsingTool then
        setToOriginalValues = true
        Humanoid.WalkSpeed = 0
        Humanoid.JumpPower = 0

        if not mainTrack then
            local anim = Instance.new("Animation")
            anim.AnimationId = MAIN_ANIMATIONS.MAIN
            mainTrack = Humanoid:LoadAnimation(anim)
            mainTrack.Looped = true
            mainTrack:Play()
        end
    elseif setToOriginalValues then
        setToOriginalValues = false
        Humanoid.WalkSpeed = 16
        Humanoid.JumpPower = 50
        if mainTrack then
            mainTrack:Stop()
            mainTrack = nil
        end
    end
end)
print("Spectral X V2 Jerk Off Animation Loaded Successfully!")
